这份复习指南旨在帮助你在两天内高效率地覆盖《程序语言与编译原理》的核心考点。考虑到你的薄弱环节在后半学期（指称语义、不动点、Monad、霍尔逻辑），我们将重点分配更多时间给这些理论性较强的部分。

---

### **第一天：编译器前端与指称语义基础**

#### **上午：词法分析与语法分析（考试必考各一题）**
*   **词法分析（Lexical Analysis）：**
    *   **核心考点：** **正则表达式**到**NFA**再到**DFA**的转化。
    *   **重点概念：** 掌握 **Flex** 的匹配原则——**最长匹配原则**和**规则先后顺序原则**。
    *   **复习建议：** 重点练习如何写出标识符和常数的正则表达式，并能够手动画出状态转移图（DFA）。
*   **语法分析（Parsing）：**
    *   **核心考点：** **上下文无关语法 (CFG)**、**移入-规约分析 (Shift-Reduce)**。
    *   **重点概念：** 区分左结合与右结合，掌握如何通过引入新的非终结符来**消除歧义**（如优先级处理）。理解 **First 集合**和 **Follow 集合**的计算，这是判定规约时机的重要依据。
    *   **Bison 工具：** 了解如何在 `.y` 文件中定义优先级（`%left`, `%right`）以及如何构建**抽象语法树 (AST)**。

#### **下午：指称语义 (Denotational Semantics)**
*   **基础概念：** 语义是程序状态到状态（或值）的映射。例如，整数表达式语义 $[[e]]: state \to \mathbb{Z}$。
*   **布尔与程序语句：**
    *   布尔表达式的语义通常定义为使该表达式为真的状态集合。
    *   **赋值语句：** 修改状态中对应变量的值。
    *   **顺序执行：** 关系的复合（$D1 \circ D2$）。
    *   **If 语句：** 基于 `test_true` 和 `test_false` 的并集。
*   **While 循环语义：** 这是难点。理解 **`boundedLB` (有界语义)** 的定义，即通过迭代 $n$ 次来逼近循环的完整语义。

---

### **第二天：攻克薄弱环节（不动点、Monad、霍尔逻辑）**

#### **上午：不动点定理与 Monad 理论（理论大题高发区）**
*   **不动点定理 (Fixed-Point Theorem)：**
    *   **核心定义：** 理解 **偏序集 (Partial Ordering)**、**完备偏序集 (CPO)** 和 **单调连续函数**。
    *   **Kleene 不动点定理：** 最小不动点可以通过从最小元素 $\bot$ 开始不断迭代函数 $F$ 并取上确界（lub）得到，即 $lub\{\bot, F(\bot), F(F(\bot)), \dots\}$。
    *   **应用：** While 循环的语义被定义为特定函数 $F$ 的最小不动点。
*   **Monad 理论：**
    *   **核心定义：** 必须记住 `bind` (>>=) 和 `return` (ret) 的含义。
    *   **常见单子：** 
        *   **Set Monad（集合单子）：** 用于描述非确定性计算。
        *   **State Monad（状态单子）：** 用于描述带存储状态的计算。
        *   **SetMonadE：** 结合了非确定性和**错误处理（abort）**，常用于定义带越界检查的表达式语义。

#### **下午：霍尔逻辑与程序验证（最薄弱点加强）**
*   **基础霍尔逻辑：**
    *   **三元组 $\{P\} c \{Q\}$：** 前条件 $P$ 成立时，执行 $c$ 终止后的状态满足 $Q$。
    *   **核心规则：** 顺序执行规则、If 规则、**While 规则（循环不变量）**。
    *   **循环不变量 (Loop Invariant)：** 这是考试难点。不变量 $P$ 必须满足：(1) 初始进入时成立；(2) 循环体执行后保持成立；(3) 结合循环终止条件能推出后条件。
*   **分离逻辑 (Separation Logic)：**
    *   **核心符号：** **分离合取 $P * Q$**，表示内存可以拆分为互不相交的两部分，分别满足 $P$ 和 $Q$。
    *   **重点：** 掌握 `store(a, b)`（地址 $a$ 存值 $b$）和 **单链表谓词 `sll(p)`** 的定义及其在指针程序验证中的应用。
*   **Monad 上的霍尔逻辑：** 了解如何对单子程序进行推理，如 `Hoare_bind` 和 `Hoare_ret`。

#### **晚上：综合复习与代码细节**
*   **寄存器分配（后端）：** 快速浏览**活性分析 (Liveness Analysis)** 和干扰图染色算法（Simplify, Spill, Select）。
*   **Coq 定义：** 熟悉讲义中给出的 Coq 数据结构定义，如 `expr` 和 `com` 的归纳定义，防止考试中出现形式化定义的题目。

---

### **高分技巧与建议**
1.  **重视循环不变量：** 霍尔逻辑题目的核心通常是寻找循环不变量。如果不确定，可以尝试列举前几次迭代的状态，寻找关于变量之间关系的守恒式（如 $n*y + x = m$）。
2.  **区分 DFA 构造：** 在做词法分析题时，确保你清楚如何通过“子集构造法”将 NFA 转换为 DFA，并正确标记终止状态。
3.  **Monad 记号转换：** 熟练掌握 `x <- c1;; c2` 记号与 `bind` 函数之间的等价转换，这是阅读和编写单子程序的基础。

**类比记忆：**
如果把**指称语义**看作是程序运行的“说明书”（告诉你输入输出的关系），那么**霍尔逻辑**就是“质检单”（通过逻辑推导确保程序符合规格）。而 **Monad** 则像是一个“物流系统”，它帮你打理好了数据流转和特殊情况（如报错或状态更新）的细节，让你能专注于核心逻辑的编写。